<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å ±åˆ°ç³»çµ± | ä½³é‡Œå¥‡ç¾é†«é™¢114å¹´åº¦é¤æ•˜</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Noto Sans TC', sans-serif;
      background-color: #0b1c2c;
      color: #f1f1f1;
      background-image: radial-gradient(circle at 30% 20%, rgba(255,255,255,0.08), transparent 40%),
                        radial-gradient(circle at 70% 80%, rgba(255,255,255,0.05), transparent 40%);
      background-attachment: fixed;
      min-height: 100vh;
    }

    .navbar {
      background: rgba(10, 10, 10, 0.7);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }

    .navbar-brand {
      font-weight: 700;
      color: #ffcc66 !important;
    }

    .nav-link {
      color: #eee !important;
      font-weight: 500;
    }

    .nav-link:hover {
      color: #ffcc66 !important;
    }

    h2 {
      color: #ffcc66;
      font-weight: 600;
    }

    iframe {
      border: none;
      border-radius: 10px;
      width: 100%;
      height: 80vh;
      box-shadow: 0 0 15px rgba(0,0,0,0.5);
      background: #fff;
    }

    footer {
      text-align: center;
      color: #ccc;
      background: rgba(255,255,255,0.05);
      padding: 15px;
      margin-top: 60px;
      font-size: 0.95rem;
    }

    .refresh-btn {
      background-color: #ffcc66;
      color: #000;
      border: none;
      font-weight: 600;
      border-radius: 8px;
      padding: 10px 20px;
      margin-bottom: 15px;
      transition: 0.3s;
    }

    .refresh-btn:hover {
      background-color: #ffd866;
      transform: scale(1.05);
    }

    .timer {
      font-size: 0.9rem;
      color: #aaa;
    }
  </style>
</head>

<body>
  <!-- å°è¦½åˆ— -->
  <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
    <div class="container">
      <a class="navbar-brand" href="index.html">ä½³é‡Œå¥‡ç¾é†«é™¢114å¹´åº¦é¤æ•˜</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item"><a class="nav-link" href="index.html">é¦–é </a></li>
          <li class="nav-item"><a class="nav-link" href="schedule.html">æ´»å‹•æµç¨‹</a></li>
          <li class="nav-item"><a class="nav-link" href="teachers.html">æ•™å¸«èŠ³åéŒ„</a></li>
          <li class="nav-item"><a class="nav-link active" href="checkin.html">å ±åˆ°ç³»çµ±</a></li>
          <li class="nav-item"><a class="nav-link" href="survey.html">æ»¿æ„åº¦èª¿æŸ¥</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- ä¸»å…§å®¹ -->
  <main class="container my-5 pt-5 text-center">
    <h2 class="mb-4 mt-5">ğŸ“ ç·šä¸Šå ±åˆ°è¡¨å–®</h2>
    <p class="mb-4 text-light">è«‹èˆ‡æœƒäººå“¡æ–¼ç¾å ´æƒææˆ–é»æ“Šä¸‹æ–¹è¡¨å–®é€²è¡Œå ±åˆ°ã€‚</p>

    <!-- Google Form å ±åˆ°è¡¨å–® -->
    <iframe src="https://docs.google.com/forms/d/e/1FAIpQLScfRD9jGQfE1KKhZL-e5GbQxMqrxF_jUktrbTq1ZPX-aTYYuA/viewform?embedded=true" 
            frameborder="0" marginheight="0" marginwidth="0">
      è¼‰å…¥ä¸­â€¦
    </iframe>

    <hr class="my-5">

    <h2 class="mb-3">âœ… å³æ™‚å ±åˆ°çµ±è¨ˆèˆ‡åå–®</h2>
    <p class="text-light">å¯æ‰‹å‹•é‡æ–°æ•´ç†ï¼Œæˆ–ç­‰å¾…æ¯ 30 ç§’è‡ªå‹•æ›´æ–°ã€‚</p>

    <!-- åˆ·æ–°æŒ‰éˆ•èˆ‡å€’æ•¸ -->
    <div class="d-flex justify-content-center align-items-center gap-3 mb-3">
      <button class="refresh-btn" onclick="refreshSheet()">âŸ³ é‡æ–°æ•´ç†åå–®</button>
      <span id="countdown" class="timer"></span>
    </div>

    <!-- Google Sheet çµ±è¨ˆèˆ‡åå–® -->
    <iframe id="sheetFrame"
      src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTrWrUlYBT1UZlStu0-z162vUHPcHT4LfDh8gAYUpkHPvaLLk6Iex2f693Tyin1ghVOD1YumyLhGtCA/pubhtml?gid=111564405&single=true"
      frameborder="0" marginheight="0" marginwidth="0" height="600">
      è¼‰å…¥ä¸­â€¦
    </iframe>
  </main>

  <!-- é å°¾ -->
  <footer>
    Â© 2025 ä½³é‡Œå¥‡ç¾é†«é™¢ï¼æ•™å­¸ç ”ç©¶çµ„ | Designed for 114å¹´åº¦é¤æ•˜
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    const frame = document.getElementById('sheetFrame');
    const countdownEl = document.getElementById('countdown');
    let counter = 30;

    function refreshSheet() {
      const src = frame.src;
      frame.src = src;
      counter = 30;
    }

    setInterval(() => {
      counter--;
      if (counter <= 0) {
        refreshSheet();
      }
      countdownEl.textContent = `â³ ${counter} ç§’å¾Œè‡ªå‹•æ›´æ–°`;
    }, 1000);
  </script>
</body>
</html>
